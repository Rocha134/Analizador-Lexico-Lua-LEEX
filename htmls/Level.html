<link rel = "stylesheet" href="coloreado.css"><body> <p><br><span class=identifier>Level</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>Class</span><span class=delimitador>{</span><span class=delimitador>}</span><br><br><span class=identifier>require</span><span class=espacio> </span><span class=string>"Switch"</span><br><br><span class=keyword>function</span><span class=espacio> </span><span class=identifier>Level</span><span class=puntuacion>:</span><span class=identifier>init</span><span class=delimitador>(</span><span class=identifier>mapx</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>mapy</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>mapz</span><span class=delimitador>)</span><br>&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>sprites</span><span class=operator>=</span><span class=espacio> </span><span class=delimitador>{</span><br>&emsp;<span class=identifier>main</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>love</span><span class=puntuacion>.</span><span class=identifier>graphics</span><span class=puntuacion>.</span><span class=identifier>newImage</span><span class=delimitador>(</span><span class=string>"graphics/isometric_pixel_0121.png"</span><span class=delimitador>)</span><span class=puntuacion>,</span><br>&emsp;<span class=identifier>floor</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>love</span><span class=puntuacion>.</span><span class=identifier>graphics</span><span class=puntuacion>.</span><span class=identifier>newImage</span><span class=delimitador>(</span><span class=string>"graphics/isometric_pixel_0087.png"</span><span class=delimitador>)</span><span class=puntuacion>,</span><br>&emsp;<span class=identifier>rock</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>love</span><span class=puntuacion>.</span><span class=identifier>graphics</span><span class=puntuacion>.</span><span class=identifier>newImage</span><span class=delimitador>(</span><span class=string>"graphics/isometric_pixel_0022.png"</span><span class=delimitador>)</span><span class=puntuacion>,</span><br>&emsp;<span class=identifier>wall</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>love</span><span class=puntuacion>.</span><span class=identifier>graphics</span><span class=puntuacion>.</span><span class=identifier>newImage</span><span class=delimitador>(</span><span class=string>"graphics/isometric_pixel_0025.png"</span><span class=delimitador>)</span><span class=puntuacion>,</span><br>&emsp;<span class=identifier>goal</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>love</span><span class=puntuacion>.</span><span class=identifier>graphics</span><span class=puntuacion>.</span><span class=identifier>newImage</span><span class=delimitador>(</span><span class=string>"graphics/isometric_pixel_0098.png"</span><span class=delimitador>)</span><span class=puntuacion>,</span><br>&emsp;<span class=identifier>switch</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>love</span><span class=puntuacion>.</span><span class=identifier>graphics</span><span class=puntuacion>.</span><span class=identifier>newImage</span><span class=delimitador>(</span><span class=string>"graphics/isometric_pixel_0021.png"</span><span class=delimitador>)</span><span class=puntuacion>,</span><br>&emsp;<span class=identifier>piston</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>love</span><span class=puntuacion>.</span><span class=identifier>graphics</span><span class=puntuacion>.</span><span class=identifier>newImage</span><span class=delimitador>(</span><span class=string>"graphics/isometric_pixel_0024.png"</span><span class=delimitador>)</span><br>&emsp;<span class=delimitador>}</span><br>&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=delimitador>{</span><span class=delimitador>}</span><br>&emsp;<span class=identifier>MAPXMAX</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>mapx</span><br>&emsp;<span class=identifier>MAPYMAX</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>mapy</span><br>&emsp;<span class=identifier>MAPZMAX</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>mapz</span><br>&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>switches</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=delimitador>{</span><span class=delimitador>}</span><br>&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=delimitador>{</span><span class=delimitador>}</span><br>&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>sounds</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=delimitador>{</span><span class=delimitador>}</span><br><span class=keyword>end</span><br><br><span class=keyword>function</span><span class=espacio> </span><span class=identifier>Level</span><span class=puntuacion>:</span><span class=identifier>newSwitch</span><span class=delimitador>(</span><span class=identifier>x</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>y</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>z</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>key</span><span class=delimitador>)</span><br>&emsp;<span class=keyword>for</span><span class=espacio> </span><span class=identifier>i</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=int>1</span><span class=puntuacion>,</span><span class=espacio> </span><span class=int>10</span><span class=espacio> </span><span class=keyword>do</span><br>&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>switches</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=keyword>nil</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>switches</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>Switch</span><span class=delimitador>(</span><span class=identifier>x</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>y</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>z</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>key</span><span class=delimitador>)</span><br>&emsp;&emsp;&emsp;<span class=keyword>break</span><br>&emsp;&emsp;<span class=keyword>end</span><br>&emsp;<span class=keyword>end</span><br><span class=keyword>end</span><br><br><span class=keyword>function</span><span class=espacio> </span><span class=identifier>Level</span><span class=puntuacion>:</span><span class=identifier>newPiston</span><span class=delimitador>(</span><span class=identifier>x</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>y</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>z</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>code</span><span class=delimitador>)</span><br>&emsp;<span class=identifier>dx</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=int>0</span><br>&emsp;<span class=identifier>dy</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=int>0</span><br>&emsp;<span class=identifier>dz</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=int>0</span><br>&emsp;<span class=comentario>--Code is in format dir/key, 2 each
</span><br>&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>code</span><span class=puntuacion>:</span><span class=identifier>sub</span><span class=delimitador>(</span><span class=int>1</span><span class=puntuacion>,</span><span class=espacio> </span><span class=int>1</span><span class=delimitador>)</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"+"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;<span class=identifier>magnitude</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=int>1</span><br>&emsp;<span class=keyword>elseif</span><span class=espacio> </span><span class=espacio> </span><span class=identifier>code</span><span class=puntuacion>:</span><span class=identifier>sub</span><span class=delimitador>(</span><span class=int>1</span><span class=puntuacion>,</span><span class=espacio> </span><span class=int>1</span><span class=delimitador>)</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"-"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;<span class=identifier>magnitude</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=operator>-</span><span class=int>1</span><br>&emsp;<span class=keyword>end</span><br>&emsp;<span class=comentario>--Direction
</span><br>&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>code</span><span class=puntuacion>:</span><span class=identifier>sub</span><span class=delimitador>(</span><span class=int>2</span><span class=puntuacion>,</span><span class=espacio> </span><span class=int>2</span><span class=delimitador>)</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"x"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;<span class=identifier>dx</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>magnitude</span><br>&emsp;<span class=keyword>elseif</span><span class=espacio> </span><span class=identifier>code</span><span class=puntuacion>:</span><span class=identifier>sub</span><span class=delimitador>(</span><span class=int>2</span><span class=puntuacion>,</span><span class=espacio> </span><span class=int>2</span><span class=delimitador>)</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"y"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;<span class=identifier>dy</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>magnitude</span><br>&emsp;<span class=keyword>elseif</span><span class=espacio> </span><span class=identifier>code</span><span class=puntuacion>:</span><span class=identifier>sub</span><span class=delimitador>(</span><span class=int>2</span><span class=puntuacion>,</span><span class=espacio> </span><span class=int>2</span><span class=delimitador>)</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"z"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;<span class=identifier>dz</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>magnitude</span><br>&emsp;<span class=keyword>end</span><br>&emsp;<span class=comentario>--Key
</span><br>&emsp;<span class=identifier>key</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>code</span><span class=puntuacion>:</span><span class=identifier>sub</span><span class=delimitador>(</span><span class=int>3</span><span class=puntuacion>,</span><span class=espacio> </span><span class=int>4</span><span class=delimitador>)</span><br><br>&emsp;<span class=keyword>for</span><span class=espacio> </span><span class=identifier>i</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=int>1</span><span class=puntuacion>,</span><span class=espacio> </span><span class=int>10</span><span class=espacio> </span><span class=keyword>do</span><br>&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=keyword>nil</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>Piston</span><span class=delimitador>(</span><span class=identifier>x</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>y</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>z</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>dx</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>dy</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>dz</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>key</span><span class=delimitador>)</span><br>&emsp;&emsp;&emsp;<span class=keyword>break</span><br>&emsp;&emsp;<span class=keyword>end</span><br>&emsp;<span class=keyword>end</span><br><span class=keyword>end</span><br><br><span class=keyword>function</span><span class=espacio> </span><span class=identifier>Level</span><span class=puntuacion>:</span><span class=identifier>CheckSwitches</span><span class=delimitador>(</span><span class=identifier>player</span><span class=delimitador>)</span><br>&emsp;<span class=keyword>for</span><span class=espacio> </span><span class=identifier>i</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=int>1</span><span class=puntuacion>,</span><span class=espacio> </span><span class=int>10</span><span class=espacio> </span><span class=keyword>do</span><br>&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>switches</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=keyword>nil</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;<span class=keyword>break</span><br>&emsp;&emsp;<span class=keyword>end</span><br>&emsp;&emsp;<span class=identifier>playerup</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>player</span><span class=puntuacion>.</span><span class=identifier>gridx</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>switches</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=espacio> </span><span class=keyword>and</span><span class=espacio> </span><span class=identifier>player</span><span class=puntuacion>.</span><span class=identifier>gridy</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>switches</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=espacio> </span><span class=keyword>and</span><span class=espacio> </span><span class=identifier>player</span><span class=puntuacion>.</span><span class=identifier>gridz</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>switches</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=int>1</span><br>&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>switches</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>switches</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>switches</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=int>1</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>~=</span><span class=espacio> </span><span class=string>"empty"</span><span class=espacio> </span><span class=keyword>or</span><span class=espacio> </span><span class=identifier>playerup</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>:</span><span class=identifier>ActivateSwitches</span><span class=delimitador>(</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>switches</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>key</span><span class=delimitador>)</span><br>&emsp;&emsp;<span class=keyword>else</span><br>&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>:</span><span class=identifier>DeactivateSwitches</span><span class=delimitador>(</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>switches</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>key</span><span class=delimitador>)</span><br>&emsp;&emsp;<span class=keyword>end</span><br>&emsp;<span class=keyword>end</span><br><span class=keyword>end</span><br><br><span class=keyword>function</span><span class=espacio> </span><span class=identifier>Level</span><span class=puntuacion>:</span><span class=identifier>ActivateSwitches</span><span class=delimitador>(</span><span class=identifier>key</span><span class=delimitador>)</span><br>&emsp;<span class=keyword>for</span><span class=espacio> </span><span class=identifier>i</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=int>1</span><span class=puntuacion>,</span><span class=espacio> </span><span class=int>10</span><span class=espacio> </span><span class=keyword>do</span><br>&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=keyword>nil</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;<span class=keyword>break</span><br>&emsp;&emsp;<span class=keyword>end</span><br>&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>key</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=identifier>key</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>:</span><span class=identifier>push</span><span class=delimitador>(</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dx</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dy</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dz</span><span class=delimitador>)</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=int>1</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"rock"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=string>"rock"</span><br>&emsp;&emsp;&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=int>1</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=string>"empty"</span><br>&emsp;&emsp;&emsp;&emsp;<span class=keyword>else</span><br>&emsp;&emsp;&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=string>"empty"</span><br>&emsp;&emsp;&emsp;&emsp;<span class=keyword>end</span><br>&emsp;&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dx</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dy</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dz</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=string>"piston"</span><br>&emsp;&emsp;&emsp;<span class=keyword>end</span><br>&emsp;&emsp;<span class=keyword>end</span><br>&emsp;<span class=keyword>end</span><br><span class=keyword>end</span><br><br><span class=keyword>function</span><span class=espacio> </span><span class=identifier>Level</span><span class=puntuacion>:</span><span class=identifier>DeactivateSwitches</span><span class=delimitador>(</span><span class=identifier>key</span><span class=delimitador>)</span><br>&emsp;<span class=keyword>for</span><span class=espacio> </span><span class=identifier>i</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=int>1</span><span class=puntuacion>,</span><span class=espacio> </span><span class=int>10</span><span class=espacio> </span><span class=keyword>do</span><br>&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=keyword>nil</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;<span class=keyword>break</span><br>&emsp;&emsp;<span class=keyword>end</span><br>&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>key</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=identifier>key</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>:</span><span class=identifier>push</span><span class=delimitador>(</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dx</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dy</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dz</span><span class=puntuacion>,</span><span class=espacio> </span><span class=operator>-</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dx</span><span class=puntuacion>,</span><span class=espacio> </span><span class=operator>-</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dy</span><span class=puntuacion>,</span><span class=espacio> </span><span class=operator>-</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dz</span><span class=delimitador>)</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dx</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dy</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dz</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=int>1</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"rock"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dx</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dy</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dz</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=string>"rock"</span><br>&emsp;&emsp;&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dx</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dy</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dz</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=int>1</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=string>"empty"</span><br>&emsp;&emsp;&emsp;&emsp;<span class=keyword>else</span><br>&emsp;&emsp;&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dx</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dy</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>dz</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=string>"empty"</span><br>&emsp;&emsp;&emsp;&emsp;<span class=keyword>end</span><br>&emsp;&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>pistons</span><span class=delimitador>[</span><span class=identifier>i</span><span class=delimitador>]</span><span class=puntuacion>.</span><span class=identifier>z</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=string>"piston"</span><br>&emsp;&emsp;&emsp;<span class=keyword>end</span><br>&emsp;&emsp;<span class=keyword>end</span><br>&emsp;<span class=keyword>end</span><br><span class=keyword>end</span><br><br><br><span class=keyword>function</span><span class=espacio> </span><span class=identifier>Level</span><span class=puntuacion>:</span><span class=identifier>statusReport</span><span class=delimitador>(</span><span class=identifier>x</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>y</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>z</span><span class=delimitador>)</span><br>&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>x</span><span class=espacio> </span><span class=operator>>=</span><span class=espacio> </span><span class=int>0</span><span class=espacio> </span><span class=keyword>and</span><span class=espacio> </span><span class=identifier>x</span><span class=espacio> </span><span class=operator><=</span><span class=espacio> </span><span class=identifier>MAPXMAX</span><span class=espacio> </span><span class=keyword>and</span><span class=espacio> </span><span class=identifier>y</span><span class=espacio> </span><span class=operator>>=</span><span class=espacio> </span><span class=int>0</span><span class=espacio> </span><span class=keyword>and</span><span class=espacio> </span><span class=identifier>y</span><span class=espacio> </span><span class=operator><=</span><span class=espacio> </span><span class=identifier>MAPYMAX</span><span class=espacio> </span><span class=keyword>and</span><span class=espacio> </span><span class=identifier>z</span><span class=espacio> </span><span class=operator>>=</span><span class=espacio> </span><span class=int>0</span><span class=espacio> </span><span class=keyword>and</span><span class=espacio> </span><span class=identifier>z</span><span class=espacio> </span><span class=operator><=</span><span class=espacio> </span><span class=identifier>MAPZMAX</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>z</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"empty"</span><span class=espacio> </span><span class=keyword>and</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>-</span><span class=espacio> </span><span class=int>1</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>~=</span><span class=espacio> </span><span class=string>"empty"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;<span class=keyword>return</span><span class=espacio> </span><span class=string>"free"</span><br>&emsp;&emsp;<span class=keyword>elseif</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>z</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"rock"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;<span class=keyword>return</span><span class=espacio> </span><span class=string>"movable"</span><br>&emsp;&emsp;<span class=keyword>elseif</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>z</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"empty"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;<span class=keyword>return</span><span class=espacio> </span><span class=string>"usable"</span><br>&emsp;&emsp;<span class=keyword>else</span><br>&emsp;&emsp;&emsp;<span class=keyword>return</span><span class=espacio> </span><span class=string>"no"</span><br>&emsp;&emsp;<span class=keyword>end</span><br>&emsp;<span class=keyword>else</span><br>&emsp;&emsp;<span class=keyword>return</span><span class=espacio> </span><span class=string>"no"</span><br>&emsp;<span class=keyword>end</span><br><span class=keyword>end</span><br><br><span class=keyword>function</span><span class=espacio> </span><span class=identifier>Level</span><span class=puntuacion>:</span><span class=identifier>push</span><span class=delimitador>(</span><span class=identifier>x</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>y</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>z</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>dx</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>dy</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>dz</span><span class=delimitador>)</span><br>&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>:</span><span class=identifier>statusReport</span><span class=delimitador>(</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dx</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dy</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dz</span><span class=delimitador>)</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"free"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dx</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dy</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dz</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>z</span><span class=delimitador>]</span><br>&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>z</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=string>"empty"</span><br>&emsp;&emsp;<span class=keyword>return</span><span class=espacio> </span><span class=keyword>true</span><br>&emsp;<span class=keyword>elseif</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>:</span><span class=identifier>statusReport</span><span class=delimitador>(</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dx</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dy</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dz</span><span class=delimitador>)</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"movable"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>:</span><span class=identifier>push</span><span class=delimitador>(</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dx</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dy</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dz</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>dx</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>dy</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>dz</span><span class=delimitador>)</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dx</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dy</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dz</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>z</span><span class=delimitador>]</span><br>&emsp;&emsp;&emsp;<span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>z</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=string>"empty"</span><br>&emsp;&emsp;&emsp;<span class=keyword>return</span><span class=espacio> </span><span class=keyword>true</span><br>&emsp;&emsp;<span class=keyword>else</span><br>&emsp;&emsp;&emsp;<span class=keyword>return</span><span class=espacio> </span><span class=keyword>false</span><br>&emsp;&emsp;<span class=keyword>end</span><br>&emsp;<span class=keyword>elseif</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>:</span><span class=identifier>statusReport</span><span class=delimitador>(</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dx</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dy</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dz</span><span class=delimitador>)</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"usable"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;<span class=keyword>return</span><span class=espacio> </span><span class=keyword>true</span><br>&emsp;<span class=keyword>elseif</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>:</span><span class=identifier>statusReport</span><span class=delimitador>(</span><span class=identifier>x</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dx</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>y</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dy</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>z</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=identifier>dz</span><span class=delimitador>)</span><span class=espacio> </span><span class=operator>==</span><span class=espacio> </span><span class=string>"no"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;<span class=keyword>return</span><span class=espacio> </span><span class=keyword>false</span><br>&emsp;<span class=keyword>end</span>&emsp;&emsp;<br><span class=keyword>end</span><br><br><br><span class=keyword>function</span><span class=espacio> </span><span class=identifier>Level</span><span class=puntuacion>:</span><span class=identifier>render</span><span class=delimitador>(</span><span class=identifier>player</span><span class=delimitador>)</span><br>&emsp;<span class=keyword>for</span><span class=espacio> </span><span class=identifier>z</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=int>0</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>MAPZMAX</span><span class=espacio> </span><span class=keyword>do</span><br>&emsp;&emsp;<span class=keyword>for</span><span class=espacio> </span><span class=identifier>x</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=int>0</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>MAPXMAX</span><span class=espacio> </span><span class=keyword>do</span><br>&emsp;&emsp;&emsp;<span class=keyword>for</span><span class=espacio> </span><span class=identifier>y</span><span class=espacio> </span><span class=operator>=</span><span class=espacio> </span><span class=int>0</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>MAPYMAX</span><span class=espacio> </span><span class=keyword>do</span><br>&emsp;&emsp;&emsp;&emsp;<span class=keyword>if</span><span class=espacio> </span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>z</span><span class=delimitador>]</span><span class=espacio> </span><span class=operator>~=</span><span class=espacio> </span><span class=string>"empty"</span><span class=espacio> </span><span class=keyword>then</span><br>&emsp;&emsp;&emsp;&emsp;&emsp;<span class=identifier>love</span><span class=puntuacion>.</span><span class=identifier>graphics</span><span class=puntuacion>.</span><span class=identifier>draw</span><span class=delimitador>(</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>sprites</span><span class=delimitador>[</span><span class=identifier>self</span><span class=puntuacion>.</span><span class=identifier>layout</span><span class=delimitador>[</span><span class=identifier>x</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>y</span><span class=delimitador>]</span><span class=delimitador>[</span><span class=identifier>z</span><span class=delimitador>]</span><span class=delimitador>]</span><span class=puntuacion>,</span><span class=espacio> </span><span class=identifier>VIRTUAL_WIDTH</span><span class=operator>/</span><span class=int>2</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=int>21</span><span class=operator>*</span><span class=delimitador>(</span><span class=identifier>x</span><span class=operator>-</span><span class=identifier>z</span><span class=delimitador>)</span><span class=espacio> </span><span class=operator>-</span><span class=espacio> </span><span class=int>21</span><span class=operator>*</span><span class=delimitador>(</span><span class=identifier>y</span><span class=operator>-</span><span class=identifier>z</span><span class=delimitador>)</span><span class=puntuacion>,</span><span class=espacio> </span><span class=int>50</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=int>12</span><span class=operator>*</span><span class=delimitador>(</span><span class=identifier>x</span><span class=operator>-</span><span class=identifier>z</span><span class=delimitador>)</span><span class=espacio> </span><span class=operator>+</span><span class=espacio> </span><span class=int>12</span><span class=espacio> </span><span class=operator>*</span><span class=delimitador>(</span><span class=identifier>y</span><span class=operator>-</span><span class=identifier>z</span><span class=delimitador>)</span><span class=delimitador>)</span><br>&emsp;&emsp;&emsp;&emsp;<span class=keyword>end</span><br>&emsp;&emsp;&emsp;&emsp;<span class=comentario>--if x == player.gridx and y == player.gridy and z == player.gridz then
</span><br>&emsp;&emsp;&emsp;&emsp;<span class=espacio> </span><span class=espacio> </span><span class=comentario>--  player:render()
</span><br>&emsp;&emsp;&emsp;&emsp;<span class=comentario>--end
</span><br>&emsp;&emsp;&emsp;<span class=keyword>end</span><br>&emsp;&emsp;<span class=keyword>end</span><br>&emsp;<span class=keyword>end</span><br><span class=keyword>end</span><p/> <body/>